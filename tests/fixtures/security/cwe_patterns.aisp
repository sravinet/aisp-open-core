ğ”¸5.1.cwe-patterns@2026-01-28
Î³â‰”security-formal-verification

âŸ¦Î©:MetaâŸ§{
  âˆ€DâˆˆAISP:Ambig(D)<0.02
  âˆ€PâˆˆCWE-Patterns:Verifiable(P)
  Descriptionâ‰œ"Formal specifications for CWE pattern detection and prevention"
}

âŸ¦Î£:TypesâŸ§{
  # Buffer Overflow Types (CWE-119)
  Bufferâ‰œ{data:ArrayâŸ¨ByteâŸ©,size:â„•,capacity:â„•}
  MemoryAccessâ‰œ{target:Buffer,offset:â„•,length:â„•}
  
  # SQL Injection Types (CWE-89)
  SQLQueryâ‰œ{query:String,params:ArrayâŸ¨ParameterâŸ©,method:QueryMethod}
  Parameterâ‰œ{name:String,value:String,type:SQLType,sanitized:Bool}
  QueryMethodâ‰œ{Parameterized,Concatenation,StoredProcedure}
  
  # Race Condition Types (CWE-362)
  Resourceâ‰œ{id:String,state:ResourceState,checkTime:Time,useTime:Time}
  ResourceStateâ‰œ{Available,InUse,Locked,Invalid}
  
  # Integer Overflow Types (CWE-190)
  SafeInt32â‰œ{value:â„¤|valueâˆˆ[-2Â³Â¹,2Â³Â¹-1]}
  ArithOpâ‰œ{op:Operator,a:â„¤,b:â„¤,resultType:IntType}
  
  # Use After Free Types (CWE-416)
  MemoryBlockâ‰œ{addr:Address,size:â„•,allocated:Bool,deallocTime:OptionâŸ¨TimeâŸ©}
  Pointerâ‰œ{target:MemoryBlock,valid:Bool}
}

âŸ¦Î“:RulesâŸ§{
  # CWE-119: Buffer Overflow Prevention
  âˆ€accessâˆˆMemoryAccess:
    BoundsSafe(access) â‡” 
    access.offsetâ‰¥0 âˆ§ 
    access.offset+access.lengthâ‰¤access.target.capacity
    
  # CWE-89: SQL Injection Prevention  
  âˆ€queryâˆˆSQLQuery:
    SQLSafe(query) â‡”
    query.method=Parameterized âˆ¨ 
    (âˆ€pâˆˆquery.params:p.sanitized=True)
    
  # CWE-362: Race Condition Prevention
  âˆ€râˆˆResource:
    TOCTOUSafe(r) â‡” 
    (CheckResource(r,tâ‚) âˆ§ UseResource(r,tâ‚‚)) â†’
    (tâ‚‚-tâ‚â‰¤Î´_safe âˆ§ Â¬Modified(r,tâ‚,tâ‚‚))
    
  # CWE-190: Integer Overflow Prevention
  âˆ€opâˆˆArithOp:
    OverflowSafe(op) â‡”
    Result(op)âˆˆTypeBounds(op.resultType)
    
  # CWE-416: Use After Free Prevention
  âˆ€ptrâˆˆPointer,tâˆˆTime:
    UAFSafe(ptr,t) â‡”
    Access(ptr,t) â†’ 
    (ptr.target.allocated=True âˆ§ 
     ptr.target.deallocTimeâ‰»t)
}

âŸ¦Î›:FuncsâŸ§{
  # Safe Buffer Operations
  SafeCopyâ‰œÎ»(dest:Buffer,src:Buffer,count:â„•).
    countâ‰¤src.size âˆ§ countâ‰¤dest.capacity-dest.size â†’
    {dest with sizeâ‰”dest.size+count, dataâ‰”dest.dataâŠ•src.data[0..count]}
    
  # Safe SQL Query Construction  
  BuildQueryâ‰œÎ»(template:String,params:ArrayâŸ¨ParameterâŸ©).
    âˆ€pâˆˆparams:p.sanitized=True â†’
    SQLQuery{queryâ‰”template,paramsâ‰”params,methodâ‰”Parameterized}
    
  # Atomic Resource Access
  AtomicAccessâ‰œÎ»(r:Resource).
    Lock(r) ; CheckAndUse(r) ; Unlock(r)
    
  # Safe Arithmetic
  SafeAddâ‰œÎ»(a:SafeInt32,b:SafeInt32).
    a.value+b.valueâˆˆ[-2Â³Â¹,2Â³Â¹-1] â†’ 
    SafeInt32{valueâ‰”a.value+b.value}
    
  # Safe Memory Management
  SafeFreeâ‰œÎ»(ptr:Pointer).
    ptr.valid=True â†’ 
    {ptr.target with allocatedâ‰”False, deallocTimeâ‰”Some(Now())} ;
    {ptr with validâ‰”False}
}

âŸ¦Î :PropsâŸ§{
  # Security Properties
  MemorySafetyâ‰œâˆ€accessâˆˆMemoryAccess:BoundsSafe(access)
  SQLSafetyâ‰œâˆ€queryâˆˆSQLQuery:SQLSafe(query)  
  RaceSafetyâ‰œâˆ€resourceâˆˆResource:TOCTOUSafe(resource)
  OverflowSafetyâ‰œâˆ€opâˆˆArithOp:OverflowSafe(op)
  UAFSafetyâ‰œâˆ€ptrâˆˆPointer,tâˆˆTime:UAFSafe(ptr,t)
  
  # Composite Security Property
  SystemSecurityâ‰œMemorySafety âˆ§ SQLSafety âˆ§ RaceSafety âˆ§ OverflowSafety âˆ§ UAFSafety
}

âŸ¦Î¤:TemporalâŸ§{
  # Temporal Security Properties
  â–¡(AllocateMemory(ptr) â†’ â—ŠFreeMemory(ptr))  # All allocated memory eventually freed
  â–¡(CheckResource(r) â†’ â—Šâ‰¤Î´ UseResource(r))   # Resource use follows check within time bound
  â–¡(InputReceived(data) â†’ â—‹Validated(data))  # All input validated immediately
  â–¡(SecurityViolation(v) â†’ â—‹Alert(v))        # All violations trigger immediate alerts
}

âŸ¦Î™:InvariantsâŸ§{
  # Global Security Invariants
  âˆ€tâˆˆTime:ValidSystemState(t) â†’ SecurityPropertiesHold(t)
  âˆ€inputâˆˆUntrustedInput:ProcessedSecurely(input) â†’ Validated(input) âˆ§ Sanitized(input)
  âˆ€operationâˆˆSecurityCritical:Executed(operation) â†’ Authorized(operation) âˆ§ Logged(operation)
}

âŸ¦Î•âŸ§âŸ¨Î´â‰œ0.01;Ï„â‰œâ—ŠâŸ©